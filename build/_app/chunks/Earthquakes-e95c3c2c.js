import{S as f,i as g,s as y,K as _,L as m}from"./index-d36043ac.js";import v from"../pages/MiniScroller.svelte-5fd002f6.js";import{w as h}from"./index-fb66156c.js";const C={};let b=h([]);function k(r,n,a){let s;_(r,b,t=>a(0,s=t));const{getMap:c,getMapbox:i}=m(C),e=c(),l=i();if(e.getSource("earthquakes")){console.log("exists");let t={type:"FeatureCollection",crs:{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}},features:s};e.getSource("earthquakes").setData(t)}else e.addSource("earthquakes",{type:"geojson",data:{type:"FeatureCollection",crs:{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}},features:s},cluster:!0,clusterMaxZoom:14,clusterRadius:50}),e.addLayer({id:"clusters",type:"circle",source:"earthquakes",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#51bbd6",100,"#f1f075",750,"#f28cb1"],"circle-radius":["step",["get","point_count"],20,100,30,750,40]}}),e.addLayer({id:"cluster-count",type:"symbol",source:"earthquakes",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12}}),e.addLayer({id:"unclustered-point",type:"circle",source:"earthquakes",filter:["!",["has","point_count"]],paint:{"circle-color":"#11b4da","circle-radius":4,"circle-stroke-width":1,"circle-stroke-color":"#fff"}});return e.on("click","clusters",function(t){const o=e.queryRenderedFeatures(t.point,{layers:["clusters"]}),u=o[0].properties.cluster_id;e.getSource("earthquakes").getClusterExpansionZoom(u,function(p,d){p||e.easeTo({center:o[0].geometry.coordinates,zoom:d})})}),e.on("mouseenter","clusters",function(){e.getCanvas().style.cursor="pointer"}),e.on("mouseleave","clusters",function(){e.getCanvas().style.cursor=""}),e.on("click","unclustered-point",function(t){const o=t.features[0].geometry.coordinates.slice();for(;Math.abs(t.lngLat.lng-o[0])>180;)o[0]+=t.lngLat.lng>o[0]?360:-360;console.log(t.features[0]),e.setCenter(o),new l.Popup({}).setLngLat(o).setHTML('<div id="mini-scroller"></div>').addTo(e),new v({target:document.getElementById("mini-scroller"),props:{id:t.features[0]._vectorTileFeature.properties.id}})}),e.on("mouseenter","unclustered-point",function(){e.getCanvas().style.cursor="pointer"}),e.on("mouseleave","unclustered-point",function(){e.getCanvas().style.cursor=""}),[]}class L extends f{constructor(n){super(),g(this,n,k,null,y,{})}}export{L as E,C as c,b as i};
